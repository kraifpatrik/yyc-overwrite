# YYC Overwrite
> A simple command line tool that allows you to easily modify C++ files generated by YYC.

[![License](https://img.shields.io/github/license/kraifpatrik/yyc-overwrite)](LICENSE)

# Table of Contents
* [Features](#features)
* [Installation](#installation)
* [How to use](#how-to-use)
* [Examples](#examples)
* [Libraries](#libraries)

# Features
* Define local variables with native C++ types
* Multithreading with mutexes and semaphores

*Currently only Windows is supported!*

# Installation
* Install [Python 3](https://www.python.org/downloads/)
* Install required packages by running following command from the repo's directory:
```cmd
pip install -r requirements.txt
```
* Use [Catalyst](https://github.com/GameMakerHub/Catalyst) to install [yyc-overwrite-gml](https://github.com/kraifpatrik/yyc-overwrite-gml) into your project

# How to use
1. Open your GameMaker Studio 2 project.
2. Run the project using YYC.
3. Near the top of the Output console you will see a line like `"C:\ProgramData/GameMakerStudio2/Cache/runtimes\runtime-2.2.2.326/bin/Igor.exe"  -j=12 -options="C:\Users\kraif\AppData\Local\GameMakerStudio2\GMS2TEMP\build.bff"  -- Windows Run`. The options path is required by the tool.
4. Run the tool from the command line using
```
python yyc-overwite.py
```
5. It will ask for the path to the build.bff file. You can just press enter to leave the default value.
6. The tool now prints some info about the project, including "Target directory", which is the YYC cache directory where you can find the original C++ files.
7. In GM, you can now write code that will be used to modify the generated functions - see examples.
8. YYC Overwrite keeps running until you close it and it automatically detects changes to files and modifies them again when necessary.

# Examples
## Native C++ types for local variables
Following types should be safe to use, since they are interoperable with `YYRValue`.

```c++
bool
const char*
int
long long
float
double
```

Write a comment `/*:cpp_type*/` after variable name to specify its C++ type.

```gml
#macro COUNT 10000
var _t;

_t = get_timer();
for (var i = 0; i < COUNT; ++i) {}
show_debug_message(get_timer() - _t);

// This loop should run faster
_t = get_timer();
for (var j/*:int*/= 0; j < COUNT; ++j) {}
show_debug_message(get_timer() - _t);
```

## Run scripts in separate threads
Write `YYC_THREAD` at the beginning of a script to tell that it should run in a separate thread.

```gml
/// @desc Create event
a = 0;

// Use mutex to avoid race condition
yyc_mutex_create("m");

// Create 2 threads, both iteratively incrementing variable `a` 1000 times
repeat (2)
{
    increaseA();
}


/// @desc Draw event
draw_text(0, 0, a);


/// @func increaseA()
YYC_THREAD;

repeat (1000)
{
    yyc_mutex_acquire("m");
    ++a;
    yyc_mutex_release("m");
}
```

# Libraries
Following is a list of libraries available for YYC Overwrite.

* [yyc-tasks](https://github.com/kraifpatrik/yyc-tasks)
